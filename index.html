<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Chat-K | Simple & Dark</title>
    <style>
        :root {
            --accent: #007AFF;
            --bg: #F2F2F7;
            --card-bg: #FFFFFF;
            --text: #000000;
            --header-bg: rgba(255, 255, 255, 0.8);
            --bubble-me: #007AFF;
            --bubble-other: #E9E9EB;
        }

        /* „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâË®≠ÂÆö */
        body.dark-mode {
            --bg: #1C1C1E;
            --card-bg: #2C2C2E;
            --text: #FFFFFF;
            --header-bg: rgba(28, 28, 30, 0.8);
            --bubble-me: #0A84FF;
            --bubble-other: #3A3A3C;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; font-family: -apple-system, sans-serif; height: 100vh; 
            background: var(--bg); color: var(--text); display: flex; flex-direction: column; overflow: hidden;
            transition: background 0.3s, color 0.3s;
        }

        header { 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            background: var(--header-bg); height: 60px; display: flex; align-items: center; 
            padding: 0 20px; z-index: 2000; border-bottom: 0.5px solid rgba(0,0,0,0.1); flex-shrink: 0;
        }

        header .title { flex: 1; text-align: center; font-weight: 600; }
        header button { background: none; border: none; color: var(--accent); font-size: 24px; cursor: pointer; width: 44px; }

        .page { display: none; height: 100%; width: 100%; overflow-y: auto; }
        .page.active { display: block; animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card { background: var(--card-bg); border-radius: 16px; padding: 20px; margin: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        .btn { width: 100%; padding: 16px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 16px; margin-top: 10px; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-secondary { background: rgba(120, 120, 128, 0.16); color: var(--accent); }

        /* „Ç∞„É´„Éº„Éó„É™„Çπ„Éà */
        .group-item { 
            padding: 15px; background: var(--card-bg); border-bottom: 0.5px solid rgba(0,0,0,0.1);
            display: flex; align-items: center; cursor: pointer;
        }
        .group-item:active { background: rgba(0,0,0,0.05); }

        /* „ÉÅ„É£„ÉÉ„Éà */
        #chat-page.active { display: flex; flex-direction: column; background: var(--bg); }
        #chat-area { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px; }
        .bubble { padding: 10px 16px; border-radius: 18px; font-size: 16px; max-width: 75%; word-wrap: break-word; }
        .bubble.me { align-self: flex-end; background: var(--bubble-me); color: white; }
        .bubble.other { align-self: flex-start; background: var(--bubble-other); color: var(--text); }

        .footer { background: var(--card-bg); padding: 10px 15px 30px; display: flex; gap: 10px; border-top: 0.5px solid rgba(0,0,0,0.1); }
        textarea { flex: 1; border: none; background: rgba(120, 120, 128, 0.12); padding: 10px 15px; border-radius: 20px; color: var(--text); outline: none; height: 40px; resize: none; }

        .modal { 
            position: fixed; bottom: -100%; left: 0; width: 100%; height: 85%; 
            background: var(--card-bg); z-index: 3000; transition: 0.3s ease-out; 
            border-radius: 25px 25px 0 0; padding: 25px; box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
        }
        .modal.open { bottom: 0; }
        
        .toggle-row { display: flex; justify-content: space-between; align-items: center; margin: 20px 0; }
    </style>
</head>
<body>

<header>
    <button onclick="nav('dash')">üè†</button>
    <div class="title" id="head-title">Home</div>
    <button onclick="openModal('set-modal')">‚öôÔ∏è</button>
</header>

<div id="login-page" class="page active">
    <div style="text-align:center; padding:80px 30px;">
        <h1 style="font-size:32px;">Welcome</h1>
        <p style="color:#8E8E93;">ÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶ÈñãÂßã</p>
        <input type="text" id="u-name-input" placeholder="„ÅÇ„Å™„Åü„ÅÆÂêçÂâç" style="width:100%; padding:18px; border-radius:14px; border:1px solid #ddd; font-size:16px; margin-top:20px;">
        <button class="btn btn-primary" onclick="doLogin()">„ÅØ„Åò„ÇÅ„Çã</button>
    </div>
</div>

<div id="dash-page" class="page">
    <div class="card">
        <div style="font-size:12px; opacity:0.6;">LOGIN AS</div>
        <div id="u-display" style="font-size:24px; font-weight:bold;">---</div>
    </div>
    
    <div class="card">
        <h3 style="margin:0 0 10px;">„Éó„É≠„Ç∏„Çß„ÇØ„Éà‰∏ÄË¶ß</h3>
        <div id="group-list">
            </div>
        <button class="btn btn-secondary" onclick="createGroup()">Ôºã Êñ∞Ë¶è„Ç∞„É´„Éº„Éó‰ΩúÊàê</button>
    </div>
</div>

<div id="chat-page" class="page">
    <div id="chat-area"></div>
    <div class="footer">
        <textarea id="msg-input" placeholder="„É°„ÉÉ„Çª„Éº„Ç∏..."></textarea>
        <button onclick="sendMsg()" style="background:var(--accent); color:white; border:none; width:40px; height:40px; border-radius:50%; font-size:18px;">‚Üë</button>
    </div>
</div>

<div id="set-modal" class="modal">
    <div style="width:40px; height:5px; background:#ddd; border-radius:10px; margin:-10px auto 20px;"></div>
    <h2>Settings</h2>
    
    <div class="toggle-row">
        <span>„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ</span>
        <input type="checkbox" id="dark-toggle" onchange="toggleDarkMode()" style="width:24px; height:24px;">
    </div>

    <button class="btn btn-secondary" onclick="logout()" style="color:#FF3B30;">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
    <button class="btn btn-primary" onclick="closeModal('set-modal')">Èñâ„Åò„Çã</button>
</div>

<script>
    let groups = JSON.parse(localStorage.getItem('ck_groups')) || ["„É°„Ç§„É≥„ÉÅ„É£„ÉÉ„Éà"];

    function nav(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id + '-page').classList.add('active');
        document.getElementById('head-title').innerText = id === 'dash' ? 'Home' : 'Chat';
        if(id === 'dash') renderGroups();
    }

    function openModal(id) { document.getElementById(id).classList.add('open'); }
    function closeModal(id) { document.getElementById(id).classList.remove('open'); }

    function doLogin() {
        const name = document.getElementById('u-name-input').value;
        if(!name) return;
        localStorage.setItem('ck_user_name', name);
        document.getElementById('u-display').innerText = name;
        nav('dash');
    }

    function renderGroups() {
        const list = document.getElementById('group-list');
        list.innerHTML = "";
        groups.forEach(g => {
            const div = document.createElement('div');
            div.className = "group-item card";
            div.style.margin = "5px 0";
            div.innerText = "üìÅ " + g;
            div.onclick = () => nav('chat');
            list.appendChild(div);
        });
    }

    function createGroup() {
        const name = prompt("„Ç∞„É´„Éº„ÉóÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:");
        if(name) {
            groups.push(name);
            localStorage.setItem('ck_groups', JSON.stringify(groups));
            renderGroups();
        }
    }

    function sendMsg() {
        const inp = document.getElementById('msg-input');
        if(!inp.value.trim()) return;
        const div = document.createElement('div');
        div.className = "bubble me";
        div.innerText = inp.value;
        document.getElementById('chat-area').appendChild(div);
        document.getElementById('chat-area').scrollTop = document.getElementById('chat-area').scrollHeight;
        inp.value = "";
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        localStorage.setItem('ck_dark', document.body.classList.contains('dark-mode'));
    }

    function logout() {
        localStorage.removeItem('ck_user_name');
        location.reload();
    }

    window.onload = () => {
        // „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÂæ©ÂÖÉ
        if(localStorage.getItem('ck_dark') === 'true') {
            document.body.classList.add('dark-mode');
            document.getElementById('dark-toggle').checked = true;
        }
        // „É¶„Éº„Ç∂„ÉºÂêçÂæ©ÂÖÉ
        const savedName = localStorage.getItem('ck_user_name');
        if(savedName) {
            document.getElementById('u-display').innerText = savedName;
            nav('dash');
        }
    };
</script>
</body>
</html>
